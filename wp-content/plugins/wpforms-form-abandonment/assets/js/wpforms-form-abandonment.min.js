"use strict";var WPFormsFormAbandonment=window.WPFormsFormAbandonment||function(e,n,o){var a,t={},i=!1,r=!1,s={mobileDetect:null,init:function(){"undefined"!=typeof MobileDetect&&(s.mobileDetect=new MobileDetect(n.navigator.userAgent)),o(e).on("input",".wpforms-form-abandonment :input",s.prepData),o(e).on("change",".wpforms-form-abandonment input[type=radio]",s.prepData),o(e).on("change",".wpforms-form-abandonment input[type=checkbox]",s.prepData),o(e).on("change",".wpforms-form-abandonment .wpforms-timepicker",s.prepData),o(e).on("mouseleave",this.abandonMouse),s.isMobileDevice()?(s.isIOSDevice()&&o("a").css("cursor","pointer"),o(e).on("click",this.abandonClick)):o(e).on("mousedown",this.abandonClick),o(n).on("beforeunload",this.abandonBeforeUnload),o(".wpforms-form").on("wpformsAjaxSubmitSuccess",s.ajaxSubmitSuccess)},isMobileDevice:function(){return!!s.mobileDetect&&!!s.mobileDetect.mobile()},isIOSDevice:function(){return!!s.mobileDetect&&"iOS"===s.mobileDetect.os()},prepData:function(e){var n=o(e.target).closest(".wpforms-form");a=n.data("formid"),t[a]=n.serializeArray(),i=JSON.stringify(t),s.debug("Preping data")},sendData:function(){i&&!r&&a&&void 0!==t[a]&&(r=!0,setTimeout(function(){r=!1},1e4),s.debug("Sending"),o.post(wpforms_form_abandonment.ajaxurl,{action:"wpforms_form_abandonment",forms:i}),i=!(t={}))},abandonMouse:function(e){e.offsetX<-1||20<e.clientY||(s.debug("Mouse abandoned"),s.sendData())},abandonClick:function(e){for(var n=e.srcElement||e.target;n&&(void 0===n.tagName||"a"!==n.tagName.toLowerCase()||!n.href);)n=n.parentNode;if(n&&n.href){s.debug("Click abandoned");var o=n.href,a="internal";if("mailto"===n.protocol?a="mailto":-1===o.indexOf(wpforms_form_abandonment.home_url)&&(a="external"),!(["external","internal"].indexOf(a)<0||o.match(/^javascript\:/i))){var t=!(!n.target||n.target.match(/^_(self|parent|top)$/i))&&n.target;(e.ctrlKey||e.shiftKey||e.metaKey||2===e.which)&&(t="_blank"),(t||s.isIOSDevice())&&s.sendData()}}},abandonBeforeUnload:function(e){s.debug("Before unload abandoned"),s.sendData()},ajaxSubmitSuccess:function(){s.debug("Ajax submit success event");var e=o(this).data("formid");delete t[e],a=void 0,i=JSON.stringify(t)},debug:function(e){n.location.hash&&"#wpformsfadebug"===n.location.hash&&console.log("WPForms FA: "+e)}};return s}(document,window,jQuery);WPFormsFormAbandonment.init();